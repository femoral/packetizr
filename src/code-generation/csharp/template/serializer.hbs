using System;
using System.IO;
using System.Text;

public class {{modelType}}PacketSerializer : IPacketSerializer<{{modelType}}> {
    public byte[] Serialize({{modelType}} message) {
        using (var m = new MemoryStream()) {
            using (var w = new BinaryWriter(m)) {
                w.Write(BitConverter.GetBytes({{modelType}}.Header));
        {{#each fields as |field|~}}
            {{~#if field.isNumeric}}
                {{> serializer-numeric field}}
            {{/if}}
            {{~#if field.isVarchar}}
                {{> serializer-varchar field}}
            {{/if}}
            {{~#if field.isChar}}
                {{> serializer-char field}}{{/if}}
        {{/each}}
                return m.ToArray();
            }
        }
    }
}